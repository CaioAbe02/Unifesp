#: import SlideTransition kivy.uix.screenmanager.SlideTransition

WindowManager:
    LogoScreen:
    TelaInicial:
    Padrao:
    Cadastro:
    Login:
    MainMenu:
    AddProduct:
    ViewProduct:

<LogoScreen>
    MDScreen:
        md_bg_color: "white"
        Image:
            source: "Semestre7/Desenvolvimento de Software/PrecoBom/imgs/LOGO.png"

<TelaInicial>
    name: 'tela_inicial'
    MDScreen:
        MDFloatLayout:
            size_hint: 0.5, 0.6
            pos_hint: {"center_x": .5, "center_y": .6}
            canvas:
                Color:
                    rgb: 112/255, 170/255, 189/255
                RoundedRectangle:
                    size: self.size
                    pos: self.pos
                    radius: 50, 50, 50, 50
            Label:
                text: "Tela Inicial"
                pos_hint: {"center_x": .5, "center_y": .9}
                font_size: "18sp"

            MDFillRoundFlatButton:
                text: "Login"
                pos_hint: {"center_x": .5, "center_y": .6}
                on_release:  root.manager.current = 'login'

            MDFillRoundFlatButton:
                text: "Cadastrar"
                pos_hint: {"center_x": .5, "center_y": .3}
                on_release:  root.manager.current = 'cadastro'

        MDIconButton:
            icon: "close-circle"
            pos_hint: {"center_x": .9, "center_y": .95}
            on_release: app.close_app()

<Padrao>
    MDFloatLayout:
        size_hint: 0.5, 0.6
        pos_hint: {"center_x": .5, "center_y": .6}
        canvas:
            Color:
                rgb: 112/255, 170/255, 189/255
            RoundedRectangle:
                size: self.size
                pos: self.pos
                radius: 50, 50, 50, 50

        MDTextField:
            icon_left: "account"
            hint_text: "Usu√°rio"
            mode: "round"
            pos_hint: {"center_x": .5, "center_y": .5}
            size_hint: 0.9, None
            max_text_length: 10

        MDTextField:
            id: textfield_senha
            icon_left: 'key-variant'
            hint_text: 'Senha'
            mode: "round"
            pos_hint: {"center_x": .5, "center_y": .2}
            size_hint: 0.9, None
            password: True
            max_text_length: 10

        MDIconButton:
            icon: 'eye-off'
            pos_hint: {"center_x": .89, "center_y": .2}
            on_release:
                self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                textfield_senha.password = False if textfield_senha.password is True else True

    MDIconButton:
        icon: "close-circle"
        pos_hint: {"center_x": 0.9, "center_y": 0.9}
        on_release: app.close_app()

    MDIconButton:
        icon: "skip-backward"
        pos_hint: {"center_x": .05, "center_y": .05}
        on_release: root.manager.current = 'tela_inicial'

<Cadastro>
    name: 'cadastro'
    MDScreen:
        Padrao:
            id: padrao
            Label:
                text: "Tela de Cadastro"
                pos_hint: {"center_x": .5, "center_y": .85}
                font_size: "18sp"

        MDFillRoundFlatButton:
            text: "Cadastrar"
            pos_hint: {"center_x": .5, "center_y": .2}

<Login>
    name: 'login'
    MDScreen:
        Padrao:
            id: padrao
            Label:
                text: "Tela de Login"
                pos_hint: {"center_x": .5, "center_y": .85}
                font_size: "18sp"

        MDFillRoundFlatButton:
            text: "Login"
            pos_hint: {"center_x": .5, "center_y": .2}

<MainMenu>
    name: "main_menu"

    MDScreen:
        MDScrollView:
            id: scroll
            MDList:
                id: products_list
                TwoLineAvatarListItem:
                    text: "NVIDIA RTX 2090"
                    secondary_text: app.new_price_text(11000.00, app.calculate_discount(11550.00, 11000.00))
                    secondary_theme_text_color: "Custom"
                    secondary_text_color: "lime"
                    on_release:
                        root.manager.transition = SlideTransition()
                        root.manager.transition.direction = 'right'
                        root.manager.current = 'view_product'

                    ImageLeftWidget:
                        source: "Semestre7/Desenvolvimento de Software/PrecoBom/imgs/flores1.jpg"
                        radius: [100]

        MDFillRoundFlatIconButton:
            icon: "plus"
            text: "Adicionar produto"
            y: 0 + dp(20)
            x: root.width - self.width - dp(20)
            on_release:
                root.manager.transition = SlideTransition()
                root.manager.transition.direction = 'left'
                root.manager.current = 'add_product'

<AddProduct>
    name: "add_product"

    MDScreen:
        MDBoxLayout:
            id: add_product
            padding: dp(20)
            spacing: dp(20)
            orientation: 'vertical'
            adaptive_height: True
            y: root.height - self.height

            Label:
                text: "Adicionar Produto"
                font_size: "24sp"

            MDTextField:
                id: texfield_product_name
                hint_text: "Nome do produto"

            MDTextField:
                id: textfield_product_link
                hint_text: "Link do produto"

            Label:
                id: error_text
                text: ""

            MDBoxLayout:
                id: add_product_buttons
                adaptive_height: True
                adaptive_width: True
                pos_hint: {'right': 1}

                MDRectangleFlatButton:
                    text: "Cancelar"
                    line_color: (0, 0, 0, 0)
                    theme_text_color: "Custom"
                    text_color: "white"
                    on_release:
                        root.manager.transition = SlideTransition()
                        root.manager.transition.direction = 'right'
                        root.manager.current = 'main_menu'

                MDRaisedButton:
                    text: "Salvar"
                    on_release:
                        root.ids.error_text.text = app.save_product(root.ids.texfield_product_name.text, root.ids.textfield_product_link.text)

<ViewProduct>
    name: "view_product"

    MDScreen:
        MDBoxLayout:
            orientation: 'vertical'
            spacing: dp(40)
            padding: dp(40)
            adaptive_height: True
            y: root.height - self.height

            Label:
                id: product_name
                text: "NVIDIA RTX 2090"
                bold: True
                font_size: "18sp"

            MDBoxLayout:
                spacing: dp(10)
                pos_hint: {"center_x": .5}

                MDLabel:
                    id: original_price
                    text: "R$11.550,00"
                    theme_text_color: "Hint"
                    halign: "right"
                    strikethrough: True

                MDLabel:
                    id: discount
                    text: f"{str(int(app.calculate_discount(11550.00, 11000.00)))}%"
                    theme_text_color: "Custom"
                    text_color: "lime"
                    halign: "left"
                    size_hint: 0.9, 1

            MDLabel:
                id: new_price
                text: "R$11.000,00"
                theme_text_color: "Custom"
                text_color: "lime"
                halign: "center"

            MDRaisedButton:
                text: "Voltar"
                pos_hint: {"right": 1}
                on_release:
                    root.manager.transition = SlideTransition()
                    root.manager.transition.direction = 'left'
                    root.manager.current = 'main_menu'